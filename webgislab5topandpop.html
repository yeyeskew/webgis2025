<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OpenLayers Multi-Basemap Web App</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol/ol.css">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }
    #map {
      width: 100%;
      height: 100%;
    }
    .map-overlay {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(255,255,255,0.8);
      padding: 5px;
      border-radius: 4px;
      font-family: sans-serif;
    }
  </style>
</head>
<body>
<div id="map"></div>
<div class="map-overlay">
  <select id="basemap-select">
    <option value="osm">OSM</option>
    <option value="esri">ESRI Imagery</option>
    <option value="topo">Topographic</option>
  </select>
</div>

<script src="https://cdn.jsdelivr.net/npm/ol/ol.js"></script>
<script>
  // Base maps
  const osmLayer = new ol.layer.Tile({
    source: new ol.source.OSM(),
    visible: true,
    title: 'OSM'
  });

  const esriLayer = new ol.layer.Tile({
    source: new ol.source.XYZ({
      url: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}'
    }),
    visible: false,
    title: 'ESRI'
  });

  const topoLayer = new ol.layer.Tile({
    source: new ol.source.XYZ({
      url: 'https://{a-c}.tile.opentopomap.org/{z}/{x}/{y}.png'
    }),
    visible: false,
    title: 'Topo'
  });

  // WMS layer (states)
  const statesLayer = new ol.layer.Image({
    source: new ol.source.ImageWMS({
      url: 'https://ahocevar.com/geoserver/wms',
      params: {'LAYERS': 'topp:states', 'TILED': true},
      ratio: 1,
      serverType: 'geoserver'
    })
  });

  // Population overlay (example using GeoJSON from naturalearth)
  const populationLayer = new ol.layer.Vector({
    source: new ol.source.Vector({
      url: 'https://raw.githubusercontent.com/datasets/geo-countries/master/data/countries.geojson',
      format: new ol.format.GeoJSON()
    }),
    style: new ol.style.Style({
      fill: new ol.style.Fill({color: 'rgba(255,0,0,0.2)'}),
      stroke: new ol.style.Stroke({color: 'red', width: 1})
    })
  });

  // Map initialization
  const map = new ol.Map({
    target: 'map',
    layers: [osmLayer, esriLayer, topoLayer, statesLayer, populationLayer],
    view: new ol.View({
      center: ol.proj.fromLonLat([0, 20]),
      zoom: 2
    })
  });

  // Basemap switcher
  const select = document.getElementById('basemap-select');
  select.addEventListener('change', function() {
    const value = this.value;
    osmLayer.setVisible(value === 'osm');
    esriLayer.setVisible(value === 'esri');
    topoLayer.setVisible(value === 'topo');
  });
</script>
</body>
</html>
